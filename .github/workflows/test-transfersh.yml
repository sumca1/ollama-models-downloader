name: Test Upload (Transfer.sh - Anonymous)

on:
  workflow_dispatch:
    inputs:
      test_message:
        description: 'Test message'
        required: false
        default: 'Testing transfer.sh'

jobs:
  test-transfersh:
    runs-on: ubuntu-latest
    
    steps:
      - name: Create test file
        run: |
          echo "ğŸ§ª Creating test file..."
          mkdir -p test-upload
          cat > test-upload/test-transfersh.txt << EOF
          â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
          â•‘        Test Upload via Transfer.sh (Anonymous)         â•‘
          â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
          â•‘  Method: Transfer.sh                                   â•‘
          â•‘  Date: $(date -u +"%Y-%m-%d %H:%M:%S UTC")            â•‘
          â•‘  Message: ${{ github.event.inputs.test_message }}     â•‘
          â•‘                                                        â•‘
          â•‘  ğŸ’¡ No account needed!                                 â•‘
          â•‘  ğŸ’¡ No API key needed!                                 â•‘
          â•‘  ğŸ’¡ Files auto-delete after 14 days                    â•‘
          â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          EOF
          cat test-upload/test-transfersh.txt

      - name: Upload to Transfer.sh
        run: |
          echo "ğŸ“¤ Uploading to transfer.sh (anonymous)..."
          
          DOWNLOAD_LINK=$(curl --upload-file test-upload/test-transfersh.txt https://transfer.sh/test-transfersh.txt)
          
          if [ ! -z "$DOWNLOAD_LINK" ]; then
            echo ""
            echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
            echo "â•‘           TRANSFER.SH UPLOAD SUCCESS!                  â•‘"
            echo "â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£"
            echo "â•‘  âœ… No account needed!                                 â•‘"
            echo "â•‘  âœ… No authentication needed!                          â•‘"
            echo "â•‘  âš ï¸  Files deleted after 14 days                       â•‘"
            echo "â•‘                                                        â•‘"
            echo "â•‘  ğŸ“¥ Download link:                                     â•‘"
            echo "â•‘     $DOWNLOAD_LINK"
            echo "â•‘                                                        â•‘"
            echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
            
            # Test if accessible via NetFree
            echo ""
            echo "ğŸ” Testing accessibility..."
            HTTP_CODE=$(curl -s -o /dev/null -w "%{http_code}" "$DOWNLOAD_LINK")
            
            if [ "$HTTP_CODE" = "200" ]; then
              echo "âœ… File is accessible (HTTP $HTTP_CODE)"
            else
              echo "âš ï¸ Got HTTP $HTTP_CODE - may be blocked"
            fi
          else
            echo "âŒ Upload failed!"
          fi

      - name: Summary
        run: |
          echo ""
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
          echo "âœ… Transfer.sh test completed!"
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
          echo ""
          echo "Pros:"
          echo "  âœ… No account needed!"
          echo "  âœ… No setup required!"
          echo "  âœ… 10GB max file size"
          echo "  âœ… Simple curl upload"
          echo ""
          echo "Cons:"
          echo "  âš ï¸ Files auto-delete after 14 days"
          echo "  âš ï¸ May be blocked by NetFree (need to test)"
